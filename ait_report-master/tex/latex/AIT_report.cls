%  for a report Document at AIT
% =========================================
%
% DO NOT EDIT THIS FILE!
%
% -----------------------------------------
%
% v1.0: 18.01.2017, Tobias Glück
% v1.1: 16.03.2019, Tobias Glück dded slides functionality
% v1.2:  22.11.2019, Amadeus Lobe added up to 5 authors, only allowed utf8 code style
% --- Characteristics ---
%=========================
\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{AIT_report}[2019/03/16 style for AIT reports documents]

% --- Initialising ---
%======================
\RequirePackage{ifthen}

% --- declare options ---
%==========================
\newboolean{FormatSet}
\newboolean{FormatScript}
\newboolean{FormatSlides}

\setboolean{FormatSlides}{false}
\setboolean{FormatScript}{true}


%\DeclareOption{OutputFormat=Script}{
%\setboolean{FormatSet}{true}
%\setboolean{FormatSlides}{false}
%\setboolean{FormatScript}{true}
%}
%
%\DeclareOption{OutputFormat=Slides}{
%\setboolean{FormatSet}{true}
%\setboolean{FormatSlides}{true}
%\setboolean{FormatScript}{false}
%}

%\ifthenelse{\boolean{FormatSet}}
%{}
%{
%\setboolean{FormatScript}{true}
%}

\newboolean{LanguageSet}
\newboolean{LanguageEN}
\newboolean{LanguageDE}

\newboolean{ShowBibURL}
\setboolean{ShowBibURL}{false}

\DeclareOption{language=de}{
	\setboolean{LanguageSet}{true}
	\setboolean{LanguageDE}{true}
	\setboolean{LanguageEN}{false}
}
\DeclareOption{language=en}{
	\setboolean{LanguageSet}{true}
	\setboolean{LanguageDE}{false}
	\setboolean{LanguageEN}{true}
}

\newboolean{NoTableOfContents}
\newboolean{NoListOfFigures}
\newboolean{NoListOfTables}

\setboolean{NoTableOfContents}{false}
\setboolean{NoListOfFigures}{false}
\setboolean{NoListOfTables}{false}

\DeclareOption{NoTableOfContents}{\setboolean{NoTableOfContents}{true}}
\DeclareOption{NoListOfFigures}{\setboolean{NoListOfFigures}{true}}
\DeclareOption{NoListOfTables}{\setboolean{NoListOfTables}{true}}

\ifthenelse{\boolean{LanguageSet}}
{}
{
	\setboolean{LanguageDE}{true}
}

\ifthenelse{\boolean{LanguageDE}}{
	\PassOptionsToPackage{USenglish, main=ngerman}{babel}
	\PassOptionsToPackage{babel,german=quotes,english=american}{csquotes}
	\AtEndOfClass{\selectlanguage{ngerman}}
}{}

\ifthenelse{\boolean{LanguageEN}}{
	\PassOptionsToPackage{ngerman, main=USenglish}{babel}
	\PassOptionsToPackage{babel,english=american,german=quotes}{csquotes}
	\AtEndOfClass{\selectlanguage{USenglish}}
}{}


% --- process options ---
%=========================
\ifthenelse{\boolean{FormatScript}}{
	\newcommand{\SlidesOnly}[1]{}
	\newcommand{\ScriptOnly}[1]{#1}
}{
	\newcommand{\SlidesOnly}[1]{#1}
	\newcommand{\ScriptOnly}[1]{}		
}



\ifthenelse{\boolean{FormatScript}}
{
	\PassOptionsToPackage
	{
		headinclude,
		footinclude=false
	}{typearea} 
	\PassOptionsToClass{%
		pdftex,%
		a4paper,
		11pt,
		DIV=13, 	 % Satzspiegel Faktor
		BCOR=6mm,	 %Bindekorrektur
		parskip=false,
		oneside,
		numbers=noenddot
	}{scrreprt}
}
{
	\PassOptionsToPackage
	{
		paper=landscape,
		headinclude,
		footinclude=false
	}{typearea}
	\PassOptionsToClass
	{
		fontsize=15pt,
		BCOR=0mm,
		DIV=calc,
		headings=normal,
	}{scrreprt}
	\AtEndOfClass{
		\RequirePackage{setspace}
		\setstretch{1.1}
		\RequirePackage{enumitem}
		\setlist{itemsep=1ex, parsep=0ex}
		\RequirePackage[
		papersize={200mm,150mm},
		textwidth=180mm, %260
		top=18mm, %25
		bottom=13mm, %20
		footskip=30pt, %40pt
		headsep=15pt %20pt
		]{geometry}
	}
}

% all options that are not explicityl declared are passed to the class scrreprt:
\DeclareOption*{
	\PassOptionsToClass{\CurrentOption}{scrreprt}
}
\ProcessOptions
\relax
\LoadClass{scrreprt}

% packages for layout
\RequirePackage[automark]{scrpage2}		% Kopf-/Fusszeilen fuer KOMA-Klassen

\PassOptionsToPackage{
	final,
	bookmarks=true,				%% if true, generate PDF bookmarks (requires two passes of pdflatex)
	bookmarksopen=false,			%% if true, show all PDF bookmarks expanded
	bookmarksnumbered=true,		%% if true, add the section numbers to the bookmarks
	linkbordercolor=link_color,
	urlbordercolor=url_color,
	citebordercolor=cite_color,
	filebordercolor=link_color,
	pdfpagemode=UseOutlines, %% None, UseOutlines (=show bookmarks), UseThumbs (show thumbnails), FullScreen
	breaklinks,
	plainpages=false,
	hyperindex=true,
}{hyperref}%}

% --- chapter style anpassen ---
%========================
\addtokomafont{chapter}{\color{ait_red}}
% --- load packages ---
%========================

% packages for fonts:
\RequirePackage[utf8]{inputenc}	%windows (works with both)
\RequirePackage[T1]{fontenc}
\RequirePackage{lmodern}
\RequirePackage{textcomp}

% language
\RequirePackage{babel}
\RequirePackage{csquotes}
\ifthenelse{\boolean{LanguageDE}}{
	\selectlanguage{ngerman}
	\newcommand{\Version}{VERSIONSNUMMER}
	\newcommand{\Contact}{Kontakt}
}{}

\ifthenelse{\boolean{LanguageEN}}{
	\selectlanguage{USenglish}
	\newcommand{\Version}{VERSIONSNUMBER}
	\newcommand{\Contact}{Contact}
}{}

% packages needed for positioning of the boxes on the title page:
\RequirePackage[absolute, overlay]{textpos} %, showboxes
\RequirePackage{calc}

\RequirePackage{uarial}
\renewcommand{\familydefault}{\sfdefault}

\RequirePackage{microtype}
\RequirePackage[pdftex]{graphicx}
\RequirePackage[hyperref, pdftex]{xcolor}

\RequirePackage{placeins} % places floating objects before new section
% starts, provides \FloatBarrier which will place all remaining floating
% objects.

\RequirePackage{tikz}
\usetikzlibrary{calc}
\RequirePackage{pgfplots}
\usetikzlibrary{pgfplots.groupplots}
\pgfplotsset{compat=newest}
\pgfplotsset{legend cell align=left,tick scale binop=\times}
\pgfplotsset{grid style={loosely dotted,color=darkgray!30!gray,line width=0.6pt},tick style={black,thin}}

% packages for math stuff
\RequirePackage{amssymb}
\RequirePackage{amsmath} 
\RequirePackage{amsfonts}
\RequirePackage{amsthm}
\RequirePackage[framemethod=tex, xcolor={hyperref, pdftex}]{mdframed}[2012/02/04]
\RequirePackage{bbm}
\RequirePackage{mleftright}
\RequirePackage{xspace}
\RequirePackage{prettyref}

\RequirePackage{siunitx}
\RequirePackage{pstool}

\ifthenelse{\boolean{LanguageDE}}{
	\sisetup{locale=DE}
}{
	\sisetup{locale=US}
}
\ifthenelse{\boolean{ShowBibURL}}{
	\RequirePackage[backend=biber,
	%refsection=chapter,
	%citereset=chapter,
	style=ieee,
	citestyle=numeric-comp,
	sortcites,
	url=true,
	doi=false,
	isbn=false,
	defernumbers
	]{biblatex}
}{
	\RequirePackage[backend=biber,
	style=ieee,
	citestyle=numeric-comp,
	sortcites,
	url=false,
	doi=false,
	isbn=false,
	defernumbers
	]{biblatex}
}

\AtEndOfClass{
	\RequirePackage[colorlinks=true,
	linkcolor=ait_red,
	citecolor=ait_red,
	filecolor=ait_red,
	pagecolor=ait_red,
	urlcolor=ait_red
	]
	{hyperref}
	%\RequirePackage{breakurl}
	\RequirePackage{url}
	\ifdefined\hypcap
	\RequirePackage[all]{hypcap} % Damit werden die Links auf ein figure nicht
	% mehr auf die Bildunterschrift sondern auf den Begin der Umgebung gesetzt.
	%(must be loaded after hyperref) (macht immer wieder Probleme)
	\fi
	\ifdefined\bfSectioning
	\setkomafont{sectioning}{\normalcolor\bfseries} %schaltet auf
	%Serifenschriften fuer Ueberschriften um. (laut Markus Kohm nicht empfohlen)
	\fi
} % AtEndOfClass

% --- main part ---
%===================

\input{\MyPath AIT_report_colors}
% general macros
%==================

% title macros
% --------------
% the defintions for these commands following examples at http://www.tex.ac.uk/cgi-bin/texfaq2html?label=oarglikesect
% title
\newcommand{\Title}{\@dblarg\AIT@title}

\newcommand{\AIT@title}[2][\@error]{%
	\def\insertTitle{#2}%
	\def\AIT@shortTitle{#1}%
}
\Title{<Titel>}

% company
\newcommand{\Company}{\@dblarg\AIT@company}
\newcommand{\AIT@company}[2][\@error]{%
	\def\insertCompany{#2}%
	\def\AIT@shortCompany{#1}%
}
\Company{<Firma>}

% company logo (path to and filename with .eps!)
\newcommand\SetCompanyLogo[1]{
	\def\CompanyLogoPath{#1}
}

% Subject
\newcommand{\Subject}{\@dblarg\AIT@subject}
\newcommand{\AIT@subject}[2][\@error]{%
	\def\insertSubject{#2}%
	\def\AIT@shortSubject{#1}%
}
\Subject{Kurzzusammenfassung}

% author
\newcommand{\Author}{\@dblarg\AIT@author}
\newcommand{\AIT@author}[2][\@error]{%
	\def\insertAuthor{#2}%
	\def\AIT@shortAuthor{#1}%
}
\Author{<Autor>}

\newcommand{\AuthorSecond}{\@dblarg\AIT@authorSecond}
\newcommand{\AIT@authorSecond}[2][\@error]{%
	\def\insertAuthorSecond{#2}%
	\def\AIT@shortAuthorSecond{#1}%
}
\AuthorSecond{<Autor>}

%Added new Third Autor (AL)
\newcommand{\AuthorThird}{\@dblarg\AIT@authorThird}
\newcommand{\AIT@authorThird}[2][\@error]{%
	\def\insertAuthorThird{#2}%
	\def\AIT@shortAuthorThird{#1}%
}
\AuthorThird{<Autor>}


%Added new Fourth Autor (AL)
\newcommand{\AuthorFourth}{\@dblarg\AIT@authorFourth}
\newcommand{\AIT@authorFourth}[2][\@error]{%
	\def\insertAuthorFourth{#2}%
	\def\AIT@shortAuthorFourth{#1}%
}
\AuthorFourth{<Autor>}


%Added new Fifth Autor (AL)
\newcommand{\AuthorFifth}{\@dblarg\AIT@authorFifth}
\newcommand{\AIT@authorFifth}[2][\@error]{%
	\def\insertAuthorFifth{#2}%
	\def\AIT@shortAuthorFifth{#1}%
}
\AuthorFifth{<Autor>}

% author text
\newcommand{\AuthorText}[1]{\def\insertAuthorText{#1}}
\AuthorText{Autor}
\ifthenelse{\boolean{LanguageEN}}{
	\AuthorText{Author}
}{}

%% supervisor
%\def\Supervisor{\@dblarg\AIT@supervisor}
%\long\def\AIT@supervisor[#1]#2{%
%\def\insertSupervisor{#2}%
%\def\AIT@shortSupervisor{#1}%
%}
%\Supervisor{<Betreuer>}
%% supervisor text
%\newcommand{\SupervisorText}[1]{\def\insertSupervisorText{#1}}
%\SupervisorText{Betreuer}
%\ifthenelse{\boolean{LanguageEN}}{
%\SupervisorText{Supervisor}
%}{}

% Place and Time
\newcommand{\PlaceAndTime}{\@dblarg\AIT@placeandtime}
\newcommand{\AIT@placeandtime}[2][\@error]{%
	\def\insertPlaceAndTime{#2}%
	\def\AIT@shortPlaceAndTime{#1}%
}
\PlaceAndTime{<Ort, im Monat Jahr>}

% date
\newcommand{\Date}{\@dblarg\AIT@date}
\newcommand{\AIT@date}[2][\@error]{%
	\def\insertDate{#2}%
	\def\AIT@shortDate{#1}%
}
\Date{\today}
% PDFTitle nur notwendig, falls von Title abweichend. (Z.Bsp. falls Titel Zeilenumbrueche enthaelt)
% author
\newcommand\PDFAuthor[1]{\long\def\AIT@PDFauthor{#1}}
%\long\def\AIT@PDFauthor{#1}
\PDFAuthor{\insertAuthor}

\newcommand\PDFTitle[1]{\long\def\AIT@PDFtitle{#1}}
%\long\def\AIT@PDFtitle{#1}
\PDFTitle{\insertTitle}

\newcommand\PDFSubject[1]{\long\def\AIT@PDFsubject{#1}}
%\long\def\AIT@PDFsubject{#1}
\PDFSubject{\insertSubject}

\input{\MyPath AIT_report_macros}
\input{\MyPath AIT_report_environments}

\setcounter{secnumdepth}{2}
\setcounter{tocdepth}{3}


% ++++++++++++++++++++++++++++++
% +														 +
% + prettyref-Definitionen 		 +
% + 													 +
% ++++++++++++++++++++++++++++++


%### (let's eclipses latex parser ignore this part)
\ifthenelse{\boolean{LanguageDE}}{
	\newrefformat{fig}{Abbildung~\ref{#1}}
	\newrefformat{eq}{(\ref{#1})}
	\newrefformat{apx}{Anhang~\ref{#1}}
	\newrefformat{cha}{Kapitel~\ref{#1}}
	\newrefformat{sec}{Abschnitt~\ref{#1}}
	\newrefformat{sub}{Abschnitt~\ref{#1}}
	\newrefformat{tab}{Tabelle~\ref{#1}}
	\newrefformat{def}{Definition~\ref{#1}}
	\newrefformat{alg}{Algorithmus~\ref{#1}}
}{}
\ifthenelse{\boolean{LanguageEN}}{
	\newrefformat{fig}{Figure~\ref{#1}}
	\newrefformat{eq}{(\ref{#1})}
	\newrefformat{apx}{Appendix~\ref{#1}}
	\newrefformat{cha}{Chapter~\ref{#1}}
	\newrefformat{sec}{Section~\ref{#1}}
	\newrefformat{sub}{Section~\ref{#1}}
	\newrefformat{tab}{Section~\ref{#1}}
	\newrefformat{def}{Definition~\ref{#1}}
	\newrefformat{alg}{Algorithm~\ref{#1}}
}{}
%###


% +++++++++++++++++++++++++++
% + 												+
% + Kopf- und Fusszeilen 		+
% + 												+
% +++++++++++++++++++++++++++


%\pagestyle{scrheadings}
% umdefinieren der 'normalen' Kopf-/Fusszeilen:
% ihead: innere Kopfzeile, ohead: aeussere Kopfzeile, cfoot: mittlere Fusszeile
% [Definition fuer scrplain]{Definition fuer scrheadings}
% scrplain wird bei Seiten mit neuem Kapitel verwendet, scrheadings sonst
%\setheadsepline{.4pt}		% Linie zwischen Kopfzeile und Text
%\setfootsepline{.4pt}
%\automark[section]{section}	%leftmark wird durch subsection, rightmark durch
%section aktualisiert
\clearscrheadfoot 		% loesche bisherige Definition vollstaendig

%\ofoot[\upshape\color{ait_gray}{\Version\ \Versionsnummer}\ |\ \color{black}\thepage{}]{\upshape\color{ait_gray}{\Version\  \Versionsnummer}\ |\ \color{black}\thepage{}} 
\ofoot[\upshape\thepage{}]{\upshape\thepage{}}
% ======================
% ||   hyphen rules   ||
% ======================
\IfFileExists{hyphen_german.tex}{
	\begin{otherlanguage*}{ngerman}{
			{\input{hyphen_german.tex}}
	}\end{otherlanguage*}
}{
	\ClassWarningNoLine{AIT_report}{File hyphen_german.tex does not exist!}
}
\IfFileExists{hyphen_english.tex}{
	\begin{otherlanguage*}{USenglish}{
			{\input{hyphen_english.tex}}
	}\end{otherlanguage*}
}{
	\ClassWarningNoLine{AIT_report}{File hyphen_english.tex does not exist!}
}
%
\setlength{\TPHorizModule}{1mm}
\setlength{\TPVertModule}{1mm}

\input{\MyPath AIT_report_Title}
